NAME=sarif world
FILE=-
ARGS=-i ../sarif-ts/plugin.r2.js
CMDS=<<EOF
?e hello sarif
?ee error message
EOF
EXPECT=<<EOF
hello sarif
EOF
EXPECT_ERR=<<EOF
error message
EOF
RUN

NAME=sarif help
FILE=-
ARGS=-i ../sarif-ts/plugin.r2.js
CMDS=<<EOF
sarif help
EOF
EXPECT=<<EOF
Usage: sarif [action] [args...]
sarif add [L] [id] [M]  - add a new result with selected driver
sarif alias [newalias]  - create an alias for the sarif command
sarif export            - export added rules as sarif json
sarif help              - show this help message (-h)
sarif list [help]       - list drivers, rules and results
sarif load [file]       - import sarif info from given file
sarif r2                - generate r2 script to import current doc results
sarif reset             - unload all documents
sarif select [N]        - select the nth driver
sarif unload [N]        - unload the nth document
sarif version           - show plugin version

EOF
RUN

NAME=sarif load
CMDS=<<EOF
pwd
sarif load examples/driver.sarif.json
sarif list docs
EOF
EXPECT_ERR=
RUN

NAME=sarif drivers
CMDS=<<EOF
sarif list drivers
sarif load examples/driver.sarif.json
EOF
EXPECT_ERR=
RUN
